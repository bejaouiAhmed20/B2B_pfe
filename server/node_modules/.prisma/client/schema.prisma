generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model airport {
  id                                        String    @id @db.VarChar(36)
  nom                                       String    @db.VarChar(255)
  code                                      String    @db.VarChar(255)
  pays                                      String    @db.VarChar(255)
  description                               String?   @db.Text
  est_actif                                 Int       @default(1) @db.TinyInt
  location_id                               String?   @db.VarChar(36)
  location                                  location? @relation(fields: [location_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_05a18cde6f7417020ff28c7ea32")
  flight_flight_airport_depart_idToairport  flight[]  @relation("flight_airport_depart_idToairport")
  flight_flight_airport_arrivee_idToairport flight[]  @relation("flight_airport_arrivee_idToairport")

  @@index([location_id], map: "FK_05a18cde6f7417020ff28c7ea32")
}

model compte {
  id         String   @id @db.VarChar(36)
  solde      Decimal  @default(0.00) @db.Decimal(10, 2)
  created_at DateTime @default(now()) @db.Timestamp(0)
  updated_at DateTime @default(now()) @db.Timestamp(0)
  user_id    String?  @unique(map: "REL_6f493a3e2c48663e2adfbdaf87") @db.VarChar(36)
  user       user?    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_6f493a3e2c48663e2adfbdaf87f")
}

model contract {
  id                         String             @id @db.VarChar(36)
  clientType                 String             @db.VarChar(100)
  label                      String             @db.VarChar(255)
  contractStartDate          DateTime           @db.Date
  contractEndDate            DateTime           @db.Date
  guaranteedMinimum          Decimal            @db.Decimal(10, 2)
  travelStartDate            DateTime           @db.Date
  travelEndDate              DateTime           @db.Date
  isActive                   Int                @default(0) @db.TinyInt
  modifiedFeeAmount          Decimal?           @db.Decimal(10, 2)
  payLater                   Int                @default(0) @db.TinyInt
  payLaterTimeLimit          Int?
  minTimeBeforeBalanceFlight Int?
  invoiceStamp               Decimal?           @db.Decimal(10, 2)
  finalClientAdditionalFees  Decimal?           @db.Decimal(10, 2)
  createdAt                  DateTime           @default(now()) @db.Timestamp(0)
  updatedAt                  DateTime           @default(now()) @db.Timestamp(0)
  client_id                  String?            @db.VarChar(36)
  fixedTicketPrice           Decimal?           @db.Decimal(10, 2)
  coupon_id                  String?            @db.VarChar(36)
  user                       user?              @relation(fields: [client_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_17598b1610ffe62285e28e8679c")
  coupon                     coupon?            @relation(fields: [coupon_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_c75708b81c6ada535f1c2dfc91f")
  contract_coupons           contract_coupons[]

  @@index([client_id], map: "FK_17598b1610ffe62285e28e8679c")
  @@index([coupon_id], map: "FK_c75708b81c6ada535f1c2dfc91f")
}

model contract_coupons {
  contract_id String   @db.VarChar(36)
  coupon_id   String   @db.VarChar(36)
  contract    contract @relation(fields: [contract_id], references: [id], onDelete: Cascade, map: "FK_36a995f56238be476f861589f80")
  coupon      coupon   @relation(fields: [coupon_id], references: [id], onDelete: Cascade, map: "FK_ec15e13d892356679809f1da2ee")

  @@id([contract_id, coupon_id])
  @@index([contract_id], map: "IDX_36a995f56238be476f861589f8")
  @@index([coupon_id], map: "IDX_ec15e13d892356679809f1da2e")
}

model coupon {
  id               String                @id @db.VarChar(36)
  code             String                @unique(map: "IDX_62d3c5b0ce63a82c48e86d904b") @db.VarChar(50)
  reduction        Decimal               @db.Decimal(10, 2)
  reduction_type   coupon_reduction_type
  date_fin         DateTime              @db.Date
  date_creation    DateTime              @default(now()) @db.DateTime(6)
  contract         contract[]
  contract_coupons contract_coupons[]
  reservation      reservation[]
}

model flight {
  id                                         String                    @id @db.VarChar(36)
  titre                                      String                    @db.VarChar(255)
  prix                                       Decimal                   @db.Decimal(10, 2)
  date_depart                                DateTime                  @db.DateTime(0)
  date_retour                                DateTime                  @db.DateTime(0)
  duree                                      String?                   @db.VarChar(255)
  status                                     String                    @default("active") @db.VarChar(255)
  airport_depart_id                          String?                   @db.VarChar(36)
  airport_arrivee_id                         String?                   @db.VarChar(36)
  plane_id                                   Int?
  plane                                      plane?                    @relation(fields: [plane_id], references: [idPlane], onDelete: NoAction, onUpdate: NoAction, map: "FK_10905a337cecafd00d1bdbd67eb")
  airport_flight_airport_depart_idToairport  airport?                  @relation("flight_airport_depart_idToairport", fields: [airport_depart_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_389a25539d99a36d8724145e028")
  airport_flight_airport_arrivee_idToairport airport?                  @relation("flight_airport_arrivee_idToairport", fields: [airport_arrivee_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_79d36b186e37f0ffe262b71f0bf")
  flight_seat_reservation                    flight_seat_reservation[]
  reservation                                reservation[]
  seat_reservation                           seat_reservation[]

  @@index([plane_id], map: "FK_10905a337cecafd00d1bdbd67eb")
  @@index([airport_depart_id], map: "FK_389a25539d99a36d8724145e028")
  @@index([airport_arrivee_id], map: "FK_79d36b186e37f0ffe262b71f0bf")
}

model flight_seat_reservation {
  id             String       @id @db.VarChar(36)
  isReserved     Int          @default(0) @db.TinyInt
  flight_id      String?      @db.VarChar(36)
  seat_id        Int?
  reservation_id String?      @db.VarChar(36)
  seat           seat?        @relation(fields: [seat_id], references: [idSeat], onDelete: Cascade, onUpdate: NoAction, map: "FK_881b1226673e14a95025e44d3b7")
  flight         flight?      @relation(fields: [flight_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "FK_cd1f58906d45a4e2c107c26aaf5")
  reservation    reservation? @relation(fields: [reservation_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "FK_ddb0ee2dac1370520b7d8c9a852")

  @@index([seat_id], map: "FK_881b1226673e14a95025e44d3b7")
  @@index([flight_id], map: "FK_cd1f58906d45a4e2c107c26aaf5")
  @@index([reservation_id], map: "FK_ddb0ee2dac1370520b7d8c9a852")
}

model location {
  id          String    @id @db.VarChar(36)
  nom         String    @db.VarChar(255)
  pays        String    @db.VarChar(255)
  ville       String    @db.VarChar(255)
  description String?   @db.Text
  url_image   String?   @db.VarChar(255)
  airport     airport[]
}

model news {
  id            String   @id @db.VarChar(36)
  titre         String   @db.VarChar(255)
  contenu       String   @db.Text
  image_url     String?  @db.VarChar(255)
  date_creation DateTime @default(now()) @db.DateTime(6)
}

model plane {
  idPlane           Int      @id @default(autoincrement())
  planeModel        String   @db.VarChar(255)
  totalSeats        Int
  seatConfiguration String   @db.VarChar(255)
  flight            flight[]
  seat              seat[]
}

model reclamation {
  id            String    @id @db.VarChar(36)
  sujet         String    @db.VarChar(255)
  description   String    @db.Text
  statut        String    @default("En attente") @db.VarChar(50)
  date_creation DateTime  @default(now()) @db.DateTime(6)
  reponse       String?   @db.Text
  date_reponse  DateTime? @db.DateTime(0)
  user_id       String?   @db.VarChar(36)
  user          user?     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_fd27049738df76001d7520d2451")

  @@index([user_id], map: "FK_fd27049738df76001d7520d2451")
}

model request_solde {
  id          String               @id @db.VarChar(36)
  montant     Decimal              @db.Decimal(10, 2)
  description String?              @db.Text
  date        DateTime             @default(now()) @db.Timestamp(0)
  status      request_solde_status @default(pending)
  imageUrl    String?              @db.VarChar(255)
  client_id   String?              @db.VarChar(36)
  user        user?                @relation(fields: [client_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_a5a233949a2ddb2f01ed09075e3")

  @@index([client_id], map: "FK_a5a233949a2ddb2f01ed09075e3")
}

model reservation {
  id                      String                    @id @db.VarChar(36)
  date_reservation        DateTime                  @db.DateTime(0)
  statut                  String                    @db.VarChar(255)
  prix_total              Decimal                   @db.Decimal(10, 2)
  nombre_passagers        Int
  coupon_code             String?                   @db.VarChar(255)
  discount_amount         Decimal?                  @default(0.00) @db.Decimal(10, 2)
  class_type              String                    @default("economy") @db.VarChar(255)
  fare_type               String                    @default("light") @db.VarChar(255)
  user_id                 String?                   @db.VarChar(36)
  flight_id               String?                   @db.VarChar(36)
  coupon_id               String?                   @db.VarChar(36)
  flight_seat_reservation flight_seat_reservation[]
  flight                  flight?                   @relation(fields: [flight_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_11a1461c53ca38689b1ccd2357a")
  coupon                  coupon?                   @relation(fields: [coupon_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_2d8898d88bc2b8b8f7c2a1033c9")
  user                    user?                     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_e219b0a4ff01b85072bfadf3fd7")
  seat_reservation        seat_reservation[]

  @@index([flight_id], map: "FK_11a1461c53ca38689b1ccd2357a")
  @@index([coupon_id], map: "FK_2d8898d88bc2b8b8f7c2a1033c9")
  @@index([user_id], map: "FK_e219b0a4ff01b85072bfadf3fd7")
}

model seat {
  idSeat                  Int                       @id @default(autoincrement())
  seatNumber              String                    @db.VarChar(255)
  classType               seat_classType
  availability            Int                       @default(1) @db.TinyInt
  idPlane                 Int?
  flight_seat_reservation flight_seat_reservation[]
  plane                   plane?                    @relation(fields: [idPlane], references: [idPlane], onDelete: NoAction, onUpdate: NoAction, map: "FK_75ef17fc429c25bf6c840a0588d")
  seat_reservation        seat_reservation[]

  @@index([idPlane], map: "FK_75ef17fc429c25bf6c840a0588d")
}

model seat_reservation {
  id             Int          @id @default(autoincrement())
  seat_id        Int?
  reservation_id String?      @db.VarChar(36)
  flight_id      String?      @db.VarChar(36)
  flight         flight?      @relation(fields: [flight_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_162243f59884f20d5f0c997de0c")
  reservation    reservation? @relation(fields: [reservation_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_3f60e6f49a16a8b1561ab2fceb2")
  seat           seat?        @relation(fields: [seat_id], references: [idSeat], onDelete: NoAction, onUpdate: NoAction, map: "FK_ddb11c532175fff21e5c7ec45fa")

  @@unique([seat_id, flight_id], map: "IDX_573bbb96600a5c6dd74149335c")
  @@index([flight_id], map: "FK_162243f59884f20d5f0c997de0c")
  @@index([reservation_id], map: "FK_3f60e6f49a16a8b1561ab2fceb2")
}

model user {
  id               String          @id @db.VarChar(36)
  nom              String          @db.VarChar(255)
  email            String          @unique(map: "IDX_e12875dfb3b1d92d7d7c5377e2") @db.VarChar(255)
  numero_telephone String?         @db.VarChar(255)
  pays             String?         @db.VarChar(255)
  adresse          String?         @db.VarChar(255)
  est_admin        Int             @default(0) @db.TinyInt
  mot_de_passe     String          @db.VarChar(255)
  compte           compte?
  contract         contract[]
  reclamation      reclamation[]
  request_solde    request_solde[]
  reservation      reservation[]
}

enum seat_classType {
  economy
  business
  first
}

enum coupon_reduction_type {
  percentage
  fixed
}

enum request_solde_status {
  pending
  approved
  rejected
}
